%
% THE BEER-WARE LICENSE (Rev. 42):
% Ronny Bergmann <bergmann@mathematik.uni-kl.de> wrote this file. As long as you
% retain this notice you can do whatever you want with this stuff. If we meet
% some day, and you think this stuff is worth it, you can buy me a beer or
% coffee in return.
%
% This file is just to get started - You need the corresponding Logo
%


%\documentclass[german,10pt,xcolor=colortbl,compress
%,draft
%]{beamer}
\documentclass[german,10pt,xcolor=colortbl,compress,handout]{beamer}
\usepackage[macce]{inputenc}
\usepackage[OT1]{fontenc}
\usepackage{calc}
\usepackage[ngerman]{babel} % Neue Rechtschreibung
\usepackage{amsmath,amsthm,amssymb,euscript} % AMS-LaTeX  
\usepackage{enumerate,graphicx}
\usepackage{listings}

% Load Theme
\usetheme[noptsans,navigation=true, FB=Mathematik, frametotal=true]{TUKL}
%
\setbeamertemplate{navigation symbols}{}
\title{Real root isolation}
\subtitle{Fachpraktikum}
\date[]{\today}
\author[]{Dominik Bendle, Clara Petroll}
\institute[]{AG Algebra, Geometrie und Computeralgebra \\ Betreuer: Janko Böhm}
%Setze ein Logo auf der Titelseite unten rechts
\renewcommand{\theSecondLogo}{}

\begin{document}
	\maketitle	
	\begin{frame}{Inhalt}
		\tableofcontents
	\end{frame}
	\section{Einleitung}
	\begin{frame}{Aufgabenstellung}
		\begin{itemize}
		\item Gegeben: nulldimensionales Radikalideal $J \subseteq \mathbb{R}[x_1, \hdots, x_n]$ und eine Box $B=I_1 \times \cdots \times I_n$.
		\pause
		\item Gesucht: Finde Boxen $B_i \subseteq B$, sodass jede Box $B_i$ genau ein Element aus $V(J)$ enthält.
		\end{itemize}
	\pause
	Warum macht diese Aufgabenstellung Sinn?
	\pause	
	\begin{lemma}
	Sei $J \subseteq \mathbb{R}[x_1, \hdots, x_n]$, dann sind äquivalent:
	\begin{itemize}
		\item[a)] $J$ ist nulldimensional.
		\item[b)] $V(J)$ ist endlich.
	\end{itemize}
	\end{lemma}
	
	\end {frame}
	
	\begin{frame}{Verfahren}
		\begin{itemize}
		\item Intervallarithmetik und Exklusion, um festzustellen dass in einer Box keine Nullstelle liegt
		\pause
		\item multivariater Interval Newton Step um Eindeutigkeit einer Lösung in einer Box fest zu stellen
		\pause 
		\item Implementierung in Singular-Library
		\end{itemize}	
	\end{frame}
	
	\section{Der Algorithmus}
	\begin{frame}{Intervallarithmetik}
		\begin{definition} 
		Sei $\textbf{R} \subseteq \mathbb{R}^2$ die Menge aller Intervalle $[a,b], a < b$. 
		Eine Intervall-Erweiterung einer Abbildung $f: \mathbb{R}^n \to \mathbb{R}$ ist eine Abbildung $\textbf{f}: \textbf{R}^n \to \textbf{R}$, sodass $f(x) \in \textbf{f}(\textbf{x}) $ für alle 			$x \in \mathbb{R}$.
		\end{definition}
		Damit: simpler Exklusionstest implementierbar. \bigskip
		
		\emph{Problem:} Wie bekommt man Eindeutigkeit einer Nullstelle in einer Box? 
	\end{frame}
	
	\begin{frame}{Interval Newton Step}
		\begin{itemize}
		\pause
		\item Idee: Wollen Testfunktion $T$, die zu gegebener Funktion $f: \mathbb{R}^n \to \mathbb{R}$ und einer Box $B_i$ aussagt:
		 	\begin{itemize}
			\item $T(f,B_i)=-1$, falls keine Nullstelle von f in der Box $B_i$ liegt
			\item $T(f,B_i)=0$, falls keine Aussage getroffen werden kann
			\item $T(f,B_i)=1$, falls genau eine Nullstelle von f in der Box $B_i$ liegt
			\end{itemize}
		\end{itemize}
		\pause
		Dazu berechne den Newton-Step von $f$ und einer Box $\textbf{x}$:
		$$ N(f, \textbf{x})= \hat{x} - \textbf{f'}(\textbf{x})^{-1}f(\hat{x})$$
		(Dabei $\hat{x} \in \textbf{x}$ beliebig, $\textbf{f'}$ Intervall-Erweiterung der Jacobi-Matrix von $f$)
	\end{frame}
	
	\begin{frame}{Interval Newton Step}{Anwendung auf unser Problem}
		\begin{theorem}
		Sei $I$ ein nulldimensionales Radikalideal des Polynomrings $K[x_1, \hdots, x_n]$, wobei $K$ ein Körper ist. Dann kann I von $n$ Elementen erzeugt werden. 
		\end{theorem}
		
		\begin{itemize}
		\item nulldimensionales Radikalideal $I \subseteq \mathbb{R}[x_1, \hdots, x_n]$ somit gegeben als eine Menge an Erzeugern $\{f_1, \hdots f_n\}, f_i \in \mathbb{R}[x_1, \hdots, x_n], 			i=1,\hdots,n$
		\pause
		\item betrachte nun die Funktion $f:=\left( \begin{array}{c} f_1\\ \vdots \\ f_n \end{array} \right)$, $f:\mathbb{R}^n\to \mathbb{R}$  \\
			
		%\item Das haben wir weil... (computational methods in commutative Algebra and Algebraic geometry -> let I zeroddim radical then I generated by n elements)
		%\pause
		\end{itemize}
		$\implies$ Können den Interval Newton Step auf unser Ideal anwenden.
	\end{frame}
	
	\begin{frame}{Interval Newton step}
		\begin{theorem}
		Sei $\textbf{x}$ eine Box im $\mathbb{R}^n$ und $f:\mathbb{R}^n\to \mathbb{R}$. Dann gilt:
		\begin{itemize}
		\item[a)] Jede Lösung in $\textbf{x}$ liegt auch in $N(f,\textbf{x})$. \\
		\pause
		\item[b)] Gilt  $N(f,\textbf{x}) \subseteq int(\textbf{x})$, dann existiert genau eine Lösung in $\textbf{x}$, d.h. $T(f,\textbf{x})=1$.
		\end{itemize}
		\end{theorem}
		\pause
		
		\textbf{Implementierung:} 
		\\
		Bisektion bis für jede der entstehenden Boxen eine der folgenden Bedingungen erfüllt ist:
		\pause
		\begin{itemize}
		\item In der Box liegt genau eine Lösung.
		\item \glqq Größe\grqq{} der Box unter einer gewissen Schranke.
		\end{itemize}
		
	\end{frame}
	
	\begin {frame}[fragile]{testPolyBox}
	\lstset{language=C}
	\begin{lstlisting}
	for (i = 1; i <= ncols(I); i++) {
		   tmp = evalPolyAtBox(I[i], B);
		   // check if 0 contained in every interval
		   // return -1 if not
		   if (tmp[1]*tmp[2] > 0){return(-1, B); } 
		}
	 
	//now: Newton Step
	box Bcenter = boxCenter(B);
	ivmat J = evalJacobianAtBox(I, B);
	list inverse = ivmatGaussian(J);

	// only continue if J is invertible
	if (!inverse[1]) { return(0, B); }
	ivmat Jinverse = inverse[2];

	\end{lstlisting}
	\end{frame}
	\begin {frame}[fragile]{testPolyBox}
	\lstset{language=C}
	\begin{lstlisting}
	
	// calculate Bcenter - f(B)^(-1)f(Bcenter)	
	box fB = evalIdealAtBox(I, Bcenter);  
	fB = Bcenter - (Jinverse * fB);
	
	// algorithm will not process box further, so do not modify
	int laststep = boxIsInterior(fB, B);
	
	// else intersection is empty or non-trivial
	def Bint = intersect(B, fB);
	
	\end{lstlisting}
	\end{frame}
	\begin {frame}[fragile]{testPolyBox}
	\lstset{language=C}
	\begin{lstlisting}

	// if intersection is empty Bint == -1
	if (typeof(Bint) == "int") { return(-1, B); }

	// attempt simplification of fractions
	... 
	...
		
	if (laststep) { return(1, B); }

	// no condition could be verified
	return(0, B);
    
	\end{lstlisting}

	\end{frame}
	
	\section{Probleme und Verbesserungen}
	\begin{frame}{Schlechte Laufzeit}
		\begin{itemize}
		\item Intervallarithmetik als \glqq newstruct\grqq{} in Singular implementiert
		\item Invertieren einer Intervall-Matrix NP-schwer
		\end{itemize}
	\bigskip
	\textbf{Unsere Verbesserungen:}
	\pause
		\begin{itemize}
		\item Auslagerung der Intervallarithmetik in C++  (dynamische Moduln in Singular)
		\item Einbinden dieses Teils des Codes als .so 
		\end{itemize}
	\end{frame}
	
	\begin{frame}{Große Brüche}
		\begin{itemize}
			\pause
			\item Schneiden von Boxen $\rightarrow$ teilweise sehr große Brüche $\rightarrow$ langsam
			\pause
			\item Idee: "Runden" von Brüchen 
			\pause
			\item Umsetzung: Vergrößere die Box ein bisschen, um schönere Darstellung zu erzielen
		\end{itemize}
		\bigskip
		\pause
		
		$\implies$ Dadurch annehmbare Laufzeit sogar bei fünf Variablen.
	\end{frame}
	
	\begin{frame}{Schlechte Startboxen}
	\pause
	\begin{lemma}
	Sei $I$ ein Ideal des Polynomrings $K[x_1, \hdots, x_n]$, wobei $K$ ein Körper ist. Die folgenden Aussagen sind äquivalent:
	\begin{itemize}
	 	\item[a)] $I$ ist nulldimensional.
		\item[b)] $I \cap K[x_i] \neq \{0\}$ für $i=1,\hdots, n$.
	\end{itemize}
	\pause
	\end{lemma}
		\begin{itemize}
		\item Bestimme Gröbnerbasis des Ideals mit einer Eliminationsordnung.
		\pause
		\item $\implies$ Erste Gleichung hängt nur von einer Variablen ab.
		\pause
		\item Wende darauf unseren Exclusiontest an $\rightarrow$ bekommen bessere Startboxen für eine Variable.
		\end{itemize}
	\end{frame}
	
	\begin{frame}{Boxen mit eindeutigen Lösungen}
		\begin {itemize}
		%\item Wollen nur Boxen mit eindeutigen Lösungen.
		\item Bisher: Eingabe bestehend aus Ideal, Startbox, Schranke für die Größe der Boxen. 
		\\ $\rightsquigarrow$ \emph{Ziel:} Wollen keine Boxen, die auf Grund ihrer Größe vom Algorithmus nach Terminierung ausgegeben werden.
		\end{itemize}
	\pause
	\textbf{Unsere Verbesserungen:}
	\begin {itemize}
	\pause
	\item Falls Nullstelle auf der Ebene liegt, an der wir die Box bei Bisektion zerteilen $\implies$ nie Eindeutigkeit der Lösung mit Newton Step.
	\pause
	\item Verbesserung der Algorithmus \glqq splitBox \grqq{} durch:
	\pause
		\begin{itemize}
		\item Werte Ideal an der Zerteilungsebene aus. 
		\item Gröbnerbasistest
		\end{itemize}
	\end{itemize}
	
	\end{frame}
	% warum können wir newton step anwenden?
	% nulldimensionales Radikalideal -> immer n erzeuge??, auf jeden fall finite vanishing locus
	
	% frame zu Unser Vorgehen 
	%Probleme: sehr langsam-> Lösung?
	%Codeausschnitte
	
	%Literatur
	
	\begin{frame}{Literaturverzeichnis}
	\bibliographystyle{alphadin}
	\begin{thebibliography}{9}
	\bibitem{Moore} Cloud, Kearfott, Moore
	\textit{Introduction to Interval Analysis}.
	Society for Industrial and Applied Mathematics, 2009.
	
	
	\bibitem{Vasconcelos} Eisenbud, Grayson, Herzog, Stillman, Vasconcelos
	\textit{Computational Methods in Commutative Algebra and Algebraic Geometry}. Springer Verlag Berlin-Heidelberg, 3. Auflage 2004.
	
	\bibitem[A]{Sommese} Andrew J. Sommese and Charles W. Wampler
	\textit{The Numerical Solution of Systems of Polynomials}. [\textit{Arising in Engineering and Science}].
	World Scientific Publishing Co. Pte. Ltd., 2005.
	
	\end{thebibliography}
	
	\end{frame}
	
\end{document}